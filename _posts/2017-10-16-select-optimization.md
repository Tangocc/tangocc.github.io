---
layout:     post
title:      "MySql系列之查询优化"
subtitle:   ""
date:       2017-10-16 12:00:00
author:     "Tango"
header-img: "img/in-post/post-2017-10-11/post-bg-universe.jpg"
catalog: true
tags:   
    - MySql数据库 
---

> 如何建立最好的索引，对于高性能来说是必不可少的，但这些还不够-还需要合理设计查询。如果查询写的很糟糕，即是库表结构在合理、索引再合适，也无法实现高性能。


在进行查询优化之前，要明确的一点是，真正需要优化的是响应时间，查询由一个个小的任务组成，优化的目标要么是减少子任务数，要么减少子任务的执行时间，要么减少子任务执行次数。通常来讲，对于一个查询通常由几步完成： 从客户端到服务器，服务进行解析-》生成执行计划-》执行-》返回结果给客户端。其中，执行计划可以认为是整个生命周期中最重要的阶段，这其中包含了大量检索数据到存储引擎调用记忆调用后的数据处理，包括排序、分组等。
在完成这些任务的时候，查询需要在不同的地方花费时间，包括网络、cpu、计算、统计信息和执行计划、锁等待等操作，尤其是向底层存储心情检索数据调用操作，这些调用需要在内存操作、出操作和内存不足时导致IO操作上消耗大量的时间。
在每一个消耗大量时间的查询案例中，我们都看到一些不必要的额外操作，某些操作被额外地重复了很多次，某些操作执行太慢等。优化的目的就是减少和消除这些操作所花费的时间。  

### 是否请求不需要的数据

有些查询请求超过实际需要的数据，然而这些多余的数据会占用内存、cpu以及网络带宽，给数据库服务器带来额外而不必要的负担。
在请求数据库时，考虑一下两个方面
- 是否请求不需要的行？
- 是否请求不需要的列 ？
- 是否多次请求同样的数据？

### 是否扫描额外的记录
- 扫描行数是多少？
- 返回行数是多少？  
上述两者相差较大时则需要优化。




